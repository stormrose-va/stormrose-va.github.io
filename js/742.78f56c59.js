"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[742],{1773:function(s,e,o){o.d(e,{Z:function(){return m}});var a=o(6252),r=o(3577);const t={class:"modal-content"},i={class:"message-header"},n={class:"message-body"};function l(s,e,o,l,c,d){return(0,a.wg)(),(0,a.j4)(a.lR,{to:"body"},[(0,a._)("div",{class:(0,r.C_)(["modal",{"is-active":o.show}])},[(0,a._)("div",{class:"modal-background",onClick:e[0]||(e[0]=(...s)=>d.signalClose&&d.signalClose(...s))}),(0,a._)("div",t,[(0,a._)("article",{class:(0,r.C_)(["message",o.color])},[(0,a._)("div",i,[(0,a.WI)(s.$slots,"header",{},(()=>[(0,a._)("p",null,(0,r.zw)(o.title),1)])),(0,a._)("button",{class:"delete","aria-label":"delete",onClick:e[1]||(e[1]=(...s)=>d.signalClose&&d.signalClose(...s))})]),(0,a._)("div",n,[(0,a.WI)(s.$slots,"default")])],2)]),(0,a._)("button",{class:"modal-close is-large","aria-label":"close",onClick:e[2]||(e[2]=(...s)=>d.signalClose&&d.signalClose(...s))})],2)])}var c={name:"BaseModal",props:{show:{type:Boolean,required:!0},title:{type:String,required:!1},color:{type:String,required:!1,default:null}},emits:["close"],methods:{signalClose(){this.$emit("close")}}},d=o(3744);const u=(0,d.Z)(c,[["render",l]]);var m=u},6647:function(s,e,o){o.r(e),o.d(e,{default:function(){return Ps}});var a=o(6252);const r={class:"section"},t={class:"container"};function i(s,e,o,i,n,l){const c=(0,a.up)("password-set-form"),d=(0,a.up)("password-request-form");return(0,a.wg)(),(0,a.iD)("section",r,[(0,a._)("div",t,[l.hasToken?((0,a.wg)(),(0,a.j4)(c,{key:0,token:o.token},null,8,["token"])):((0,a.wg)(),(0,a.j4)(d,{key:1}))])])}var n=o(9963),l=o(3577);const c={key:0},d=["innerHTML"],u=(0,a.Uk)(" A password reset operation has been requested for your account. Please check your emails for further instructions. "),m={class:"columns is-centered"},h={class:"column is-5-tablet is-5-desktop is-4-widescreen"},p={class:"box"},w={class:"field"},k=(0,a._)("label",{class:"label",for:"username"},"Username",-1),f={class:"control has-icons-left"},_={class:"icon is-small is-left"},g=(0,a.Uk)(" "),v={class:"field"},y=(0,a._)("label",{class:"label",for:"email"},"Email Address",-1),P={class:"control has-icons-left"},b={class:"icon is-small is-left"},C=(0,a.Uk)(" "),q={key:0,class:"help is-danger"},I={key:1,class:"help is-success"},R={key:0,class:"message is-danger"},U=(0,a._)("div",{class:"message-body"}," Please make sure to enter a username and a valid email address. Neither of them can be empty. ",-1),S=[U],D=(0,a._)("div",{class:"field is-grouped"},[(0,a._)("div",{class:"control"},[(0,a._)("button",{class:"button is-link"},"Request Password Reset")])],-1);function W(s,e,o,r,t,i){const U=(0,a.up)("base-spinner"),W=(0,a.up)("base-modal"),L=(0,a.up)("svg-icon");return(0,a.wg)(),(0,a.iD)("section",null,[t.isLoading?((0,a.wg)(),(0,a.iD)("div",c,[(0,a.Wm)(U)])):(0,a.kq)("",!0),(0,a.Wm)(W,{show:!!t.error,color:"is-danger",title:"Password Reset Error",onClose:i.handleError},{default:(0,a.w5)((()=>[(0,a._)("section",{innerHTML:t.error},null,8,d)])),_:1},8,["show","onClose"]),(0,a.Wm)(W,{show:t.success,color:"is-success",title:"Password Reset Requested",onClose:i.handleSuccess},{default:(0,a.w5)((()=>[u])),_:1},8,["show","onClose"]),(0,a._)("div",m,[(0,a._)("div",h,[(0,a._)("div",p,[(0,a._)("form",{onSubmit:e[3]||(e[3]=(0,n.iM)(((...s)=>i.doRequestReset&&i.doRequestReset(...s)),["prevent"]))},[(0,a._)("div",w,[k,(0,a._)("div",f,[(0,a.wy)((0,a._)("input",{class:"input",type:"text",id:"username",placeholder:"Username",ref:"userInput","onUpdate:modelValue":e[0]||(e[0]=s=>t.username=s)},null,512),[[n.nr,t.username,void 0,{trim:!0}]]),(0,a._)("span",_,[(0,a.Wm)(L,{type:"mdi",path:i.userIcon},{default:(0,a.w5)((()=>[g])),_:1},8,["path"])])])]),(0,a._)("div",v,[y,(0,a._)("div",P,[(0,a.wy)((0,a._)("input",{class:(0,l.C_)(["input",{"is-danger":t.ko,"is-success":t.ok}]),type:"email",id:"email",placeholder:"Email Address","onUpdate:modelValue":e[1]||(e[1]=s=>t.email=s),onKeyup:e[2]||(e[2]=(...s)=>i.checkMail&&i.checkMail(...s))},null,34),[[n.nr,t.email,void 0,{trim:!0}]]),(0,a._)("span",b,[(0,a.Wm)(L,{type:"mdi",path:i.emailIcon},{default:(0,a.w5)((()=>[C])),_:1},8,["path"])])]),t.ko?((0,a.wg)(),(0,a.iD)("p",q,"Not a valid email address")):(0,a.kq)("",!0),t.ok?((0,a.wg)(),(0,a.iD)("p",I,"Valid email address")):(0,a.kq)("",!0)]),t.formIsValid?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("article",R,S)),D],32)])])])])}var L=o(5422),M=o(1773),V=o(2273),Z=o(5317);function $(s){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s)}var E={name:"PasswordRequestForm",components:{BaseSpinner:L.Z,BaseModal:M.Z,SvgIcon:V.Z},computed:{userIcon(){return Z.rI3},emailIcon(){return Z.bn2}},data(){return{formIsValid:!0,isLoading:!1,success:!1,error:null,username:"",email:"",ko:!1,ok:!1}},methods:{handleError(){this.error=null},handleSuccess(){this.success=!1;const s="/"+(this.$route.query.goto||"aircraft");this.$router.replace(s)},checkMail(){if(""===this.email)return this.ok=!1,void(this.ko=!1);$(this.email)?(this.ok=!0,this.ko=!1):(this.ok=!1,this.ko=!0)},async doRequestReset(){if(""===this.username||""===this.email||!$(this.email))return void(this.formIsValid=!1);this.isLoading=!0;const s={username:this.username,email:this.email};try{await this.$store.dispatch("auth/passwordResetRequest",s),this.success=!0}catch(e){this.error=e.message||"Failed to initiate password reset, try later."}this.isLoading=!1}}},B=o(3744);const F=(0,B.Z)(E,[["render",W]]);var T=F;const x={key:0},H=["innerHTML"],N=(0,a.Uk)(" Your password has been reset successfully. You can now log in using your new password. "),j={class:"columns is-centered"},A={class:"column is-5-tablet is-5-desktop is-4-widescreen"},K={class:"box"},Y={class:"field"},z=(0,a._)("label",{class:"label",for:"username"},"Username",-1),G={class:"control has-icons-left"},J={class:"icon is-small is-left"},O=(0,a.Uk)(" "),Q={class:"field"},X=(0,a._)("label",{class:"label",for:"newPassword"},"New Password",-1),ss={class:"control has-icons-left"},es={class:"icon is-small is-left"},os=(0,a.Uk)(" "),as={key:0,class:"help is-danger"},rs={key:1,class:"help is-success"},ts={class:"field"},is=(0,a._)("label",{class:"label",for:"confirmPassword"},"Confirm Password",-1),ns={class:"control has-icons-left"},ls={class:"icon is-small is-left"},cs=(0,a.Uk)(" "),ds={key:0,class:"help is-danger"},us={key:1,class:"help is-success"},ms={key:0,class:"message is-danger"},hs=(0,a._)("div",{class:"message-body"}," Please make sure to enter the same password in both fields. Neither of them can be empty. ",-1),ps=[hs],ws=(0,a._)("div",{class:"field is-grouped"},[(0,a._)("div",{class:"control"},[(0,a._)("button",{class:"button is-link"},"Confirm Password Reset")])],-1);function ks(s,e,o,r,t,i){const c=(0,a.up)("base-spinner"),d=(0,a.up)("base-modal"),u=(0,a.up)("svg-icon");return(0,a.wg)(),(0,a.iD)("section",null,[t.isLoading?((0,a.wg)(),(0,a.iD)("div",x,[(0,a.Wm)(c)])):(0,a.kq)("",!0),(0,a.Wm)(d,{show:!!t.error,color:"is-danger",title:"Password Reset Error",onClose:i.handleError},{default:(0,a.w5)((()=>[(0,a._)("section",{innerHTML:t.error},null,8,H)])),_:1},8,["show","onClose"]),(0,a.Wm)(d,{show:t.success,color:"is-success",title:"Password Reset Successful",onClose:i.handleSuccess},{default:(0,a.w5)((()=>[N])),_:1},8,["show","onClose"]),(0,a._)("div",j,[(0,a._)("div",A,[(0,a._)("div",K,[(0,a._)("form",{onSubmit:e[5]||(e[5]=(0,n.iM)(((...s)=>i.doConfirmReset&&i.doConfirmReset(...s)),["prevent"]))},[(0,a._)("div",Y,[z,(0,a._)("div",G,[(0,a.wy)((0,a._)("input",{class:"input",type:"text",id:"username",placeholder:"Username",ref:"userInput","onUpdate:modelValue":e[0]||(e[0]=s=>t.username=s)},null,512),[[n.nr,t.username,void 0,{trim:!0}]]),(0,a._)("span",J,[(0,a.Wm)(u,{type:"mdi",path:i.userIcon},{default:(0,a.w5)((()=>[O])),_:1},8,["path"])])])]),(0,a._)("div",Q,[X,(0,a._)("div",ss,[(0,a.wy)((0,a._)("input",{class:(0,l.C_)(["input",{"is-danger":t.ko,"is-success":t.ok}]),type:"password",id:"newPassword",ref:"newPassword","onUpdate:modelValue":e[1]||(e[1]=s=>t.newPassword=s),onKeyup:e[2]||(e[2]=(...s)=>i.checkPassword&&i.checkPassword(...s))},null,34),[[n.nr,t.newPassword,void 0,{trim:!0}]]),(0,a._)("span",es,[(0,a.Wm)(u,{type:"mdi",path:i.passwordIcon},{default:(0,a.w5)((()=>[os])),_:1},8,["path"])])]),t.ko?((0,a.wg)(),(0,a.iD)("p",as,"Passwords must match")):(0,a.kq)("",!0),t.ok?((0,a.wg)(),(0,a.iD)("p",rs,"Passwords do match")):(0,a.kq)("",!0)]),(0,a._)("div",ts,[is,(0,a._)("div",ns,[(0,a.wy)((0,a._)("input",{class:(0,l.C_)(["input",{"is-danger":t.ko,"is-success":t.ok}]),type:"password",id:"confirmPassword","onUpdate:modelValue":e[3]||(e[3]=s=>t.confirmPassword=s),onKeyup:e[4]||(e[4]=(...s)=>i.checkPassword&&i.checkPassword(...s))},null,34),[[n.nr,t.confirmPassword,void 0,{trim:!0}]]),(0,a._)("span",ls,[(0,a.Wm)(u,{type:"mdi",path:i.passwordIcon},{default:(0,a.w5)((()=>[cs])),_:1},8,["path"])])]),t.ko?((0,a.wg)(),(0,a.iD)("p",ds,"Passwords must match")):(0,a.kq)("",!0),t.ok?((0,a.wg)(),(0,a.iD)("p",us,"Passwords do match")):(0,a.kq)("",!0)]),t.formIsValid?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("article",ms,ps)),ws],32)])])])])}var fs={name:"PasswordSetForm",components:{BaseSpinner:L.Z,BaseModal:M.Z,SvgIcon:V.Z},props:{token:{type:String,required:!0}},computed:{userIcon(){return Z.rI3},passwordIcon(){return Z.d5D}},data(){return{formIsValid:!0,isLoading:!1,success:!1,error:null,username:"",newPassword:"",confirmPassword:"",ko:!1,ok:!1}},methods:{handleError(){this.error=null},handleSuccess(){this.success=!1;const s="/"+(this.$route.query.goto||"aircraft");this.$router.replace(s)},checkPassword(){""!==this.newPassword||""!==this.confirmPassword?this.newPassword===this.confirmPassword?(this.ko=!1,this.ok=!0):(this.ko=!0,this.ok=!1):(this.ko=!1,this.ok=!1)},async doConfirmReset(){if(""===this.username||""===this.newPassword||""===this.confirmPassword||this.newPassword!==this.confirmPassword)return void(this.formIsValid=!1);this.isLoading=!0;const s={username:this.username,token:this.token,password:this.newPassword};try{await this.$store.dispatch("auth/passwordResetConfirm",s),this.success=!0}catch(e){this.error=e.message||"Failed to complete password reset, try later."}this.isLoading=!1}}};const _s=(0,B.Z)(fs,[["render",ks]]);var gs=_s,vs={name:"UserPassword",props:["token"],components:{PasswordRequestForm:T,PasswordSetForm:gs},computed:{hasToken(){return!!this.token}}};const ys=(0,B.Z)(vs,[["render",i]]);var Ps=ys}}]);
//# sourceMappingURL=742.78f56c59.js.map